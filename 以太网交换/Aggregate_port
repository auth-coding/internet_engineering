AP：由多个物理链路捆绑在一起形成的逻辑链路。
作用：1、用于扩展链路带宽，因为当链路中的报文流量超过最大承载量时，超过的部分会被丢弃，但是用户需要的是完整的报文，所以这是不能被允许的，因此需要扩展链路的带宽，那么AP口就很好的满足了这点。

	 2、用于提高线路的可靠性，当设备间的链路断开时，这条链路上的业务就会终止，这是客户不希望看到的，那么如果将多条链路聚合在一起，聚合链路中的一条成员链路断掉以后，他的业务会被自动分配到其他仍在运作成员链路上，这样业务也就不会中断。这也就提高了链路的可靠性。


流量均衡：AP口可以用于提高链路带宽和可靠性。可是在链路带宽提高后新的问题就会随之未来，那就是如何使带宽的利用率达到最大，也就是如何最大限度的使用带宽，提高带宽的使用率。此时流量均衡算法就诞生了，流量均衡的目的就是使得聚合链路上的报文尽可能的平衡分配到每一条成员链路上，从而提高带宽使用率。

流量均衡原理：AP口采用的不同的流量均衡模式会有不同的参数要求，但是其原理都是相同的。即使用哈希算法根据源MAC、目的MAC、源IP、目的IP、L4层源端口、L4层目的端口等报文特征信息参数计算出特定报文应该选择的成员链路端口。这样根据不同的流量均衡模式所输入的不同的参数就能将不同的报文大致的平均分配到各条链路上去。  

	注：不要以为不同参数就一定会产生不同结果（输入不同参数的报文可能会选择同一条链路，例如IP模式）


AP链路聚合的两种方式：
	静态AP：通过手工的方式，将指定的物理端口加入到聚合组AP中，就可以实现多条物理链路的聚合，一旦成员端口加入聚合组后，就立即可以参与聚合组的数据收发功能，并参与流量均衡。

	动态AP（LACP）：当端口启动了LACP协议时，端口就会发送LACP报文来向对端设备的相连端口通告自己的系统优先级，系统MAC，端口ID、操作KEY等信息。对端设备收到LACP报文以后，将会根据报文中的系统ID对比两端的系统优先级，系统优先级高的一端，将会按照端口ID 的优先级从高到低（若优先级相同，则按照端口从小到大的顺序）的顺序，设置聚合组内的端口处于聚合状态，并更新发出LCAP报文，系统优先级较低的一端收到更新后的报文以后，也将相应的端口设置成聚合状态，从而使得双方在端口的加入与退出聚合组上达到一致。只有双方的端口都达到聚合状态后，才能进行数据报文的转发。
		注：LACP成员口绑定以后，会定期进行LACP报文交互，如果在一定的时间内没有收到数据包，就认为收包超时，成员口链路会自动解除绑定，端口将会处于不可进行数据转发的状态。这里的“一定时间”有两种（1、长超时模式：端口每隔30秒发送一个LACP交互报文，若90秒都还没有收到，那就判定超时。 2、短超时模式：每隔1秒发送一个LACP报文，若3秒没有收到则认定超时。）其中短超时模式是默认模式，3秒的超时时间也是默认超时时间。

哈希流量均衡控制方法：哈希流量均衡能使用户在不同的场景更加灵活的控制流量均衡。
	1、哈希扰动：AP口采用哈希散列方式进行流量均衡时，在同类型的设备间，同一条流量流量均衡时会计算出相同的路径，这也就导致了在部署了ECMP的环境下，两台同类型的设备上的同一条流会被均衡到同一台目的设备上此现象成为哈希极化。那么在不同的设备上指定不同的哈希扰动因子就会让同一条流均衡处不同的路径。

	2、同步哈西：用于解决防火墙的传统哈希算法将上下行的双向流定向到不同的防火墙上（因为一个会话的上下行流的源ip和目的ip是颠倒的），同步哈希功能可以确保双向流计算出相同的路径。

	3、指定哈希因子的获取方式：主要针对GRE等隧道报文。

	4、哈希算法模式：对不同的流量模型设置不同的哈希算法模式。


BFD检测：用于快速检测通路故障的三层协议，分为IPV4检测和IPV6检测，当检查到通路故障时，AP口上的报文将会不往该口均衡流量。

BFD产生原因：BFD能提供更快速的故障检测功能，即使是LACP运行短超时模式，也需要3秒才能检测到链路故障，那这3秒期间AP口仍然会忘该故障链路均衡流量，这样就会导致报文丢失，造成丢包。BFD能更快的检测出故障，从而使AP口不再往该故障成员链路均衡流量，避免丢包。

	注：BFD协议时三层协议，所以要建立在三层AP口上，同时一旦建立后，每个成员口都是独立进行检测。